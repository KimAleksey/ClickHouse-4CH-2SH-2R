# –ö–æ–Ω—Ñ–∏—Ä—É—Ä–∞—Ü–∏—è ClickHouse

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í —ç—Ç–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è **Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞ ClickHouse —Å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π –∏ —à–∞—Ä–¥–∏–Ω–≥–æ–º —á–µ—Ä–µ–∑ Zookeeper.

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞

- **–ù–æ–¥—ã ClickHouse:** 4  
  - –®–∞—Ä–¥ 1: clickhouse-01, clickhouse-02 (2 —Ä–µ–ø–ª–∏–∫–∏)  
  - –®–∞—Ä–¥ 2: clickhouse-03, clickhouse-04 (2 —Ä–µ–ø–ª–∏–∫–∏)  
- **–ù–æ–¥—ã Zookeeper:** 3 (–¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏)  
- **–ò–º—è –∫–ª–∞—Å—Ç–µ—Ä–∞:** `analytics_cluster`

**–ü–æ—Ä—Ç—ã:**

| –°–µ—Ä–≤–∏—Å          | HTTP  | TCP  |
|-----------------|-------|------|
| clickhouse-01   | 8123  | 9000 |
| clickhouse-02   | 8124  | 9000 |
| clickhouse-03   | 8125  | 9000 |
| clickhouse-04   | 8126  | 9000 |
| zookeeper1      | 2181  | -    |
| zookeeper2      | 2182  | -    |
| zookeeper3      | 2183  | -    |

---

## üìÅ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- **`cluster.xml`** ‚Äì –æ–ø–∏—Å—ã–≤–∞–µ—Ç —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–µ–ø–ª–∏–∫–∏ –∏ –Ω–æ–¥—ã Zookeeper.  
- **`users.xml`** ‚Äì —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ClickHouse –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞.  

–§–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ `docker-compose.yml`.

---

## –ó–∞–ø—É—Å–∫

1. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git clone https://github.com/KimAleksey/ClickHouse-4CH-2SH-2R.git
cd ClickHouse-4CH-2SH-2R
```

2. –ó–∞–ø—É—Å–∫–∞–µ–º –∫–ª–∞—Å—Ç–µ—Ä:

```bash
docker compose up -d
```

3. –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ ClickHouse –≤ DBeaver:

```text
Driver: ClickHouse
Host: localhost
Port: 8123
DB: default
Username: default
Password: default
```

–¢–∞–∫–∂–µ –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–æ–¥—ã –Ω–∞ –¥—Ä—É–≥–∏—Ö –ø–æ—Ä—Ç–∞—Ö:
- 8123
- 8124
- 8125
- 8126

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

- –ö–ª–∞—Å—Ç–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ReplicatedMergeTree, —á—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é.
- Zookeeper –Ω—É–∂–µ–Ω –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ —Ä–µ–ø–ª–∏–∫; 3 –Ω–æ–¥—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –∫–≤–æ—Ä—É–º –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å.


## üìå –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ClickHouse: –†–µ–ø–ª–∏–∫–∞—Ü–∏—è](https://clickhouse.com/docs/ru/engines/table-engines/mergetree-family/replication/)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ClickHouse: Distributed Tables](https://clickhouse.com/docs/ru/engines/table-engines/special/distributed/)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Zookeeper](https://chatgpt.com/c/695233e7-1ca8-8325-9892-916ef941fcc6#:~:text=ClickHouse%3A%20Distributed%20Tables-,%D0%94%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%86%D0%B8%D1%8F,-Zookeeper)